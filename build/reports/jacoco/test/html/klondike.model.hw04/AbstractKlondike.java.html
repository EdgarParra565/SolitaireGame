<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AbstractKlondike.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">easygo</a> &gt; <a href="index.source.html" class="el_package">klondike.model.hw04</a> &gt; <span class="el_source">AbstractKlondike.java</span></div><h1>AbstractKlondike.java</h1><pre class="source lang-java linenums">package klondike.model.hw04;


import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;
import klondike.model.hw02.PossibleRank;
import klondike.model.hw02.PossibleSuits;

/**
 * Abstract class for klondike game model types.
 * Abstracted for assigment and saves code for model types via inheritance.
 */
public abstract class AbstractKlondike implements klondike.model.hw04.KlondikeModel&lt;ValueCard&gt; {

  protected List&lt;ValueCard&gt; deck;
  protected List&lt;List&lt;ValueCard&gt;&gt; piles;
  protected List&lt;List&lt;ValueCard&gt;&gt; foundations;
  protected List&lt;ValueCard&gt; hand;
  protected List&lt;ValueCard&gt; drawDeck;
  protected boolean gameStart;
  protected int numDraw;

  /**
   * Constructor to initialize the implemented KlondikeModel methods.
   */
<span class="fc" id="L31">  protected AbstractKlondike() {</span>
<span class="fc" id="L32">    this.deck = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L33">    this.piles = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L34">    this.foundations = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L35">    this.hand = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L36">    this.drawDeck = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L37">    this.gameStart = false;</span>
<span class="fc" id="L38">    this.numDraw = 0;</span>
<span class="fc" id="L39">  }</span>

  /**
   * Method that checks if card can be placed onto another pile.
   *
   * @param move card being moved.
   * @param dest destination to where card is being moved.
   * @return boolean if the move is allowed.
   */
  protected abstract boolean validBuild(ValueCard move, ValueCard dest);

  /**
   * Method that determines if a card can be placed on an empty slot.
   *
   * @param card card being moved.
   * @return boolean if the move is allowed.
   */
  protected abstract boolean canMoveToEmpty(ValueCard card);

  /**
   * Method that checks if cards are in the same suit.
   *
   * @param move list of cards being moved.
   * @return boolean if all cards are the same.
   */
  protected abstract boolean moveSameSuit(List&lt;ValueCard&gt; move);

  @Override
  public List&lt;ValueCard&gt; createNewDeck() {
<span class="fc" id="L68">    List&lt;ValueCard&gt; newDeck = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L69" title="All 2 branches covered.">    for (PossibleRank rank : PossibleRank.values()) {</span>
<span class="fc bfc" id="L70" title="All 2 branches covered.">      for (PossibleSuits suit : PossibleSuits.values()) {</span>
<span class="fc" id="L71">        newDeck.add((ValueCard) new ValueCard(suit, rank));</span>
      }
    }
<span class="fc" id="L74">    this.deck = new ArrayList&lt;&gt;(newDeck);</span>
<span class="fc" id="L75">    return newDeck;</span>
  }

  @Override
  public void startGame(List&lt;ValueCard&gt; deck, boolean shuffle, int numPiles, int numDraw) {
<span class="fc bfc" id="L80" title="All 2 branches covered.">    if (gameStart) {</span>
<span class="fc" id="L81">      throw new IllegalStateException(&quot;IllegalStateException&quot;);</span>
    }
<span class="pc bpc" id="L83" title="1 of 2 branches missed.">    if (!checkingValidDecks(deck)) {</span>
<span class="nc" id="L84">      throw new IllegalArgumentException(&quot;Decks are invalid&quot;);</span>
    }
<span class="fc" id="L86">    paramLessCheck(numPiles, 1);</span>
<span class="fc" id="L87">    paramLessCheck(numDraw, 1);</span>
<span class="fc" id="L88">    paramLessCheck(deck.size(), numDraw);</span>
<span class="fc" id="L89">    int neededCards = (numPiles * (numPiles + 1)) / 2;</span>
<span class="fc" id="L90">    paramLessCheck(deck.size(), neededCards);</span>
<span class="fc" id="L91">    gameStart = true;</span>
<span class="fc" id="L92">    List&lt;ValueCard&gt; change = new ArrayList&lt;&gt;(deck);</span>
<span class="pc bpc" id="L93" title="1 of 2 branches missed.">    if (shuffle) {</span>
<span class="nc" id="L94">      Collections.shuffle(change);</span>
    }
<span class="fc" id="L96">    this.numDraw = numDraw;</span>
<span class="fc" id="L97">    this.piles.clear();</span>
<span class="fc" id="L98">    this.foundations.clear();</span>
<span class="fc" id="L99">    this.hand.clear();</span>
<span class="fc" id="L100">    this.drawDeck.clear();</span>
<span class="fc bfc" id="L101" title="All 2 branches covered.">    for (int pile = 0; pile &lt; numPiles; pile++) {</span>
<span class="fc" id="L102">      piles.add(new ArrayList&lt;&gt;());</span>
    }
<span class="fc bfc" id="L104" title="All 2 branches covered.">    for (int rows = 0; rows &lt; numPiles; rows++) {</span>
<span class="fc bfc" id="L105" title="All 2 branches covered.">      for (int columns = rows; columns &lt; numPiles; columns++) {</span>
<span class="fc" id="L106">        piles.get(columns).add(change.remove(0));</span>
      }
    }
<span class="fc" id="L109">    drawDeck.addAll(change);</span>
<span class="fc" id="L110">    addCardHand();</span>
<span class="fc" id="L111">    Set&lt;PossibleSuits&gt; possibleSuits = new HashSet&lt;&gt;();</span>
<span class="fc bfc" id="L112" title="All 2 branches covered.">    for (ValueCard card : deck) {</span>
<span class="fc bfc" id="L113" title="All 2 branches covered.">      if (card.possibleRank == PossibleRank.Ace) {</span>
<span class="fc" id="L114">        possibleSuits.add(card.possibleSuits);</span>
      }
<span class="fc" id="L116">    }</span>
<span class="fc bfc" id="L117" title="All 2 branches covered.">    for (int foundationCard = 0; foundationCard &lt; possibleSuits.size(); foundationCard++) {</span>
<span class="fc" id="L118">      foundations.add(new ArrayList&lt;&gt;());</span>
    }
<span class="fc" id="L120">  }</span>

  /**
   * Helper to add a card to the hand from the deck.
   * Only adds card if drawDeck is not empty and will only add however
   * many you are allowed via numDraw.
   */
  protected void addCardHand() {
<span class="pc bpc" id="L128" title="1 of 4 branches missed.">    while (hand.size() &lt; numDraw &amp;&amp; !drawDeck.isEmpty()) {</span>
<span class="fc" id="L129">      hand.add(drawDeck.remove(0));</span>
    }
<span class="fc" id="L131">  }</span>

  /**
   * Checks the deck for complete suits.
   * Returns false if suit is incomplete.
   *
   * @param deck deck being checked if it can be used in klondike.
   * @return boolean if the deck can be used.
   */
  protected boolean checkingValidDecks(List&lt;ValueCard&gt; deck) {
<span class="pc bpc" id="L141" title="2 of 4 branches missed.">    if (deck == null || deck.isEmpty()) {</span>
<span class="nc" id="L142">      return false;</span>
    }
<span class="fc bfc" id="L144" title="All 2 branches covered.">    for (ValueCard card : deck) {</span>
<span class="pc bpc" id="L145" title="1 of 2 branches missed.">      if (card == null) {</span>
<span class="nc" id="L146">        return false;</span>
      }
<span class="fc" id="L148">    }</span>
<span class="pc bpc" id="L149" title="1 of 2 branches missed.">    boolean ace = deck.stream().anyMatch(card -&gt; card.possibleRank == PossibleRank.Ace);</span>
<span class="pc bpc" id="L150" title="1 of 2 branches missed.">    if (!ace) {</span>
<span class="nc" id="L151">      return false;</span>
    }
<span class="fc" id="L153">    Map&lt;PossibleSuits, Set&lt;Integer&gt;&gt; map1 = new HashMap&lt;&gt;();</span>
<span class="fc bfc" id="L154" title="All 2 branches covered.">    for (ValueCard card : deck) {</span>
<span class="fc" id="L155">      map1.computeIfAbsent(card.possibleSuits, k -&gt; new HashSet&lt;&gt;())</span>
<span class="fc" id="L156">          .add(card.possibleRank.getNumber());</span>
<span class="fc" id="L157">    }</span>
<span class="fc bfc" id="L158" title="All 2 branches covered.">    for (Set&lt;Integer&gt; set : map1.values()) {</span>
<span class="fc" id="L159">      int min = set.stream().mapToInt(i -&gt; i).min().orElse(1);</span>
<span class="pc bpc" id="L160" title="1 of 2 branches missed.">      if (min != 1) {</span>
<span class="nc" id="L161">        return false;</span>
      }
<span class="fc" id="L163">      int max = set.stream().mapToInt(i -&gt; i).max().orElse(13);</span>
<span class="fc bfc" id="L164" title="All 2 branches covered.">      for (int gapCheck = min; gapCheck &lt;= max; gapCheck++) {</span>
<span class="pc bpc" id="L165" title="1 of 2 branches missed.">        if (!set.contains(gapCheck)) {</span>
<span class="nc" id="L166">          return false;</span>
        }
      }
<span class="fc" id="L169">    }</span>
<span class="fc" id="L170">    return true;</span>
  }

  /**
   * Helper method that checks game state.
   * Throws exception if start game has not yet been run.
   */
  protected void gameInProgress() {
<span class="pc bpc" id="L178" title="1 of 2 branches missed.">    if (!gameStart) {</span>
<span class="nc" id="L179">      throw new IllegalStateException(&quot;Game has not started&quot;);</span>
    }
<span class="fc" id="L181">  }</span>

  /**
   * Helper that checks Illegal Argument Exception using less than.
   * Throws Argument if parameter one is less than param two and lets
   * user know that parameters are invalid.
   *
   * @param param1 integer that has to be less than param2.
   * @param param2 integer that had to be greater than param1.
   */
  protected void paramLessCheck(int param1, int param2) {
<span class="fc bfc" id="L192" title="All 2 branches covered.">    if (param1 &lt; param2) {</span>
<span class="fc" id="L193">      throw new IllegalArgumentException(&quot;Illegal Argument Exception&quot;);</span>
    }
<span class="fc" id="L195">  }</span>

  /**
   * Helper that checks Illegal Argument Exception using less than or equal to.
   * Throws Argument if parameter one is less or equal to param two and lets
   * user know that parameters are invalid.
   *
   * @param param1 integer that has to be less than param2.
   * @param param2 integer that had to be greater than param1.
   */
  protected void paramLessEqualCheck(int param1, int param2) {
<span class="pc bpc" id="L206" title="1 of 2 branches missed.">    if (param1 &lt;= param2) {</span>
<span class="nc" id="L207">      throw new IllegalArgumentException(&quot;Illegal Argument Exception&quot;);</span>
    }
<span class="fc" id="L209">  }</span>

  /**
   * Helper that checks Illegal Argument Exception using .isEmpty().
   * Throws State Exception if List is empty when helper is called.
   *
   * @param any any arrayList field checking if it has valueCards.
   */
  protected void emptyCheck(List&lt;?&gt; any) {
<span class="pc bpc" id="L218" title="1 of 2 branches missed.">    if (any.isEmpty()) {</span>
<span class="nc" id="L219">      throw new IllegalStateException(&quot;Illegal State Exception&quot;);</span>
    }
<span class="fc" id="L221">  }</span>

  @Override
  public void movePile(int srcPile, int numCards, int destPile) {
<span class="nc" id="L225">    gameInProgress();</span>
<span class="nc" id="L226">    paramLessCheck(srcPile, 0);</span>
<span class="nc" id="L227">    paramLessEqualCheck(piles.size(), srcPile);</span>
<span class="nc" id="L228">    paramLessCheck(destPile, 0);</span>
<span class="nc" id="L229">    paramLessEqualCheck(piles.size(), destPile);</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">    if (srcPile == destPile) {</span>
<span class="nc" id="L231">      throw new IllegalArgumentException(&quot;Illegal Argument Exception&quot;);</span>
    }
<span class="nc" id="L233">    paramLessCheck(numCards, 1);</span>
<span class="nc" id="L234">    List&lt;ValueCard&gt; src = piles.get(srcPile);</span>
<span class="nc" id="L235">    List&lt;ValueCard&gt; dest = piles.get(destPile);</span>
<span class="nc" id="L236">    paramLessCheck(src.size(), numCards);</span>
<span class="nc" id="L237">    ValueCard srcCard = src.get(src.size() - numCards);</span>
<span class="nc bnc" id="L238" title="All 2 branches missed.">    if (dest.isEmpty()) {</span>
<span class="nc bnc" id="L239" title="All 2 branches missed.">      if (srcCard.possibleRank != PossibleRank.King) {</span>
<span class="nc" id="L240">        throw new IllegalStateException(&quot;Only King can be moved&quot;);</span>
      }
    } else {
<span class="nc" id="L243">      ValueCard destCard = dest.get(dest.size() - 1);</span>
<span class="nc bnc" id="L244" title="All 2 branches missed.">      if (srcCard.possibleRank.getNumber() != destCard.possibleRank.getNumber() - 1</span>
<span class="nc bnc" id="L245" title="All 2 branches missed.">          || !oppositeColorCheck(srcCard.possibleSuits.getSymbol(),</span>
<span class="nc" id="L246">          destCard.possibleSuits.getSymbol())) {</span>
<span class="nc" id="L247">        throw new IllegalStateException(&quot;Cannot place card&quot;);</span>
      }
    }
<span class="nc" id="L250">    List&lt;ValueCard&gt; card = new ArrayList&lt;&gt;(src.subList(src.size() - numCards, src.size()));</span>
<span class="nc" id="L251">    dest.addAll(card);</span>
<span class="nc bnc" id="L252" title="All 2 branches missed.">    for (int value = 0; value &lt; numCards; value++) {</span>
<span class="nc" id="L253">      src.remove(src.size() - 1);</span>
    }
<span class="nc" id="L255">  }</span>

  @Override
  public void moveDraw(int destPile) {
<span class="nc" id="L259">    gameInProgress();</span>
<span class="nc" id="L260">    emptyCheck(hand);</span>
<span class="nc" id="L261">    paramLessCheck(destPile, 0);</span>
<span class="nc" id="L262">    paramLessEqualCheck(piles.size(), destPile);</span>
<span class="nc" id="L263">    ValueCard card = (ValueCard) hand.get(0);</span>
<span class="nc" id="L264">    List&lt;ValueCard&gt; dest = piles.get(destPile);</span>
<span class="nc bnc" id="L265" title="All 2 branches missed.">    if (dest.isEmpty()) {</span>
<span class="nc bnc" id="L266" title="All 2 branches missed.">      if (card.possibleRank != PossibleRank.King) {</span>
<span class="nc" id="L267">        throw new IllegalStateException(&quot;King only card that can be moved&quot;);</span>
      }
    } else {
<span class="nc" id="L270">      ValueCard topCard = dest.get(dest.size() - 1);</span>
<span class="nc bnc" id="L271" title="All 2 branches missed.">      if (card.possibleRank.getNumber() != topCard.possibleRank.getNumber() - 1</span>
<span class="nc bnc" id="L272" title="All 2 branches missed.">          || !oppositeColorCheck(card.possibleSuits.getSymbol(),</span>
<span class="nc" id="L273">          topCard.possibleSuits.getSymbol())) {</span>
<span class="nc" id="L274">        throw new IllegalStateException(&quot;InvalidState&quot;);</span>
      }
    }
<span class="nc" id="L277">    dest.add(card);</span>
<span class="nc" id="L278">    hand.remove(0);</span>
<span class="nc" id="L279">    addCardHand();</span>
<span class="nc" id="L280">  }</span>

  @Override
  public void moveToFoundation(int srcPile, int foundationPile) {
<span class="nc" id="L284">    gameInProgress();</span>
<span class="nc" id="L285">    paramLessCheck(srcPile, 0);</span>
<span class="nc" id="L286">    paramLessEqualCheck(piles.size(), srcPile);</span>
<span class="nc" id="L287">    paramLessCheck(foundationPile, 0);</span>
<span class="nc" id="L288">    paramLessEqualCheck(foundations.size(), foundationPile);</span>
<span class="nc" id="L289">    List&lt;ValueCard&gt; src = piles.get(srcPile);</span>
<span class="nc" id="L290">    emptyCheck(src);</span>
<span class="nc" id="L291">    ValueCard card = (ValueCard) src.get(src.size() - 1);</span>
<span class="nc" id="L292">    List&lt;ValueCard&gt; foundation = foundations.get(foundationPile);</span>
<span class="nc bnc" id="L293" title="All 2 branches missed.">    if (!canPlaceFoundationCheck(card, foundation)) {</span>
<span class="nc" id="L294">      throw new IllegalStateException(&quot;Card cannot be moved to foundation&quot;);</span>
    }
<span class="nc" id="L296">    foundation.add(card);</span>
<span class="nc" id="L297">    src.remove(src.size() - 1);</span>
<span class="nc" id="L298">  }</span>

  @Override
  public void moveDrawToFoundation(int foundationPile) {
<span class="nc" id="L302">    gameInProgress();</span>
<span class="nc bnc" id="L303" title="All 4 branches missed.">    if (hand.isEmpty() &amp;&amp; drawDeck.isEmpty()) {</span>
<span class="nc" id="L304">      throw new IllegalStateException(&quot;IllegalStateException&quot;);</span>
    }
<span class="nc bnc" id="L306" title="All 2 branches missed.">    if (hand.isEmpty()) {</span>
<span class="nc" id="L307">      addCardHand();</span>
<span class="nc bnc" id="L308" title="All 2 branches missed.">      if (hand.isEmpty()) {</span>
<span class="nc" id="L309">        throw new IllegalStateException(&quot;IllegalStateException&quot;);</span>
      }
    }
<span class="nc bnc" id="L312" title="All 4 branches missed.">    if (foundationPile &lt; 0 || foundationPile &gt;= foundations.size()) {</span>
<span class="nc" id="L313">      throw new IllegalArgumentException(&quot;Illegal Argument Exception&quot;);</span>
    }
<span class="nc" id="L315">    ValueCard card = (ValueCard) hand.get(0);</span>
<span class="nc" id="L316">    List&lt;ValueCard&gt; foundation = foundations.get(foundationPile);</span>
<span class="nc bnc" id="L317" title="All 2 branches missed.">    if (!canPlaceFoundationCheck(card, foundation)) {</span>
<span class="nc" id="L318">      throw new IllegalStateException(&quot;Foundation only card that can be moved&quot;);</span>
    }
<span class="nc" id="L320">    foundation.add(card);</span>
<span class="nc" id="L321">    hand.remove(0);</span>
<span class="nc bnc" id="L322" title="All 2 branches missed.">    if (!drawDeck.isEmpty()) {</span>
<span class="nc" id="L323">      addCardHand();</span>
    }
<span class="nc" id="L325">  }</span>

  @Override
  public void discardDraw() {
<span class="fc" id="L329">    gameInProgress();</span>
<span class="fc" id="L330">    emptyCheck(hand);</span>
<span class="fc" id="L331">    drawDeck.add((ValueCard) hand.remove(0));</span>
<span class="fc" id="L332">    addCardHand();</span>
<span class="fc" id="L333">  }</span>

  @Override
  public int getNumRows() {
<span class="nc" id="L337">    gameInProgress();</span>
<span class="nc" id="L338">    int numRows = 0;</span>
<span class="nc bnc" id="L339" title="All 2 branches missed.">    for (List&lt;ValueCard&gt; row : piles) {</span>
<span class="nc" id="L340">      numRows = Math.max(numRows, row.size());</span>
<span class="nc" id="L341">    }</span>
<span class="nc" id="L342">    return numRows;</span>
  }

  @Override
  public int getNumPiles() {
<span class="fc" id="L347">    gameInProgress();</span>
<span class="fc" id="L348">    return piles.size();</span>
  }

  @Override
  public int getNumDraw() {
<span class="fc" id="L353">    gameInProgress();</span>
<span class="fc" id="L354">    return numDraw;</span>
  }

  @Override
  public boolean isGameOver() {
<span class="nc" id="L359">    gameInProgress();</span>
<span class="nc" id="L360">    boolean gameComplete = true;</span>
<span class="nc bnc" id="L361" title="All 2 branches missed.">    for (List&lt;ValueCard&gt; foundation : foundations) {</span>
<span class="nc bnc" id="L362" title="All 2 branches missed.">      if (foundation.size() != 13) {</span>
<span class="nc" id="L363">        gameComplete = false;</span>
<span class="nc" id="L364">        break;</span>
      }
<span class="nc" id="L366">    }</span>
<span class="nc bnc" id="L367" title="All 2 branches missed.">    if (gameComplete) {</span>
<span class="nc" id="L368">      return true;</span>
    }
<span class="nc bnc" id="L370" title="All 2 branches missed.">    if (availableMove()) {</span>
<span class="nc" id="L371">      return false;</span>
    }
<span class="nc" id="L373">    return true;</span>
  }

  /**
   * Helper to check if any move can still be made in the game.
   *
   * @return boolean checking if a move can be made.
   */
  protected boolean availableMove() {
<span class="nc bnc" id="L382" title="All 2 branches missed.">    for (int srcPile = 0; srcPile &lt; piles.size(); srcPile++) {</span>
<span class="nc" id="L383">      List&lt;ValueCard&gt; src = piles.get(srcPile);</span>
<span class="nc bnc" id="L384" title="All 2 branches missed.">      if (src.isEmpty()) {</span>
<span class="nc" id="L385">        continue;</span>
      }
<span class="nc" id="L387">      ValueCard card = src.get(src.size() - 1);</span>
<span class="nc bnc" id="L388" title="All 2 branches missed.">      for (List&lt;ValueCard&gt; foundation : foundations) {</span>
<span class="nc bnc" id="L389" title="All 2 branches missed.">        if (canPlaceFoundationCheck(card, foundation)) {</span>
<span class="nc" id="L390">          return true;</span>
        }
<span class="nc" id="L392">      }</span>
    }
<span class="nc bnc" id="L394" title="All 2 branches missed.">    for (int srcPile = 0; srcPile &lt; piles.size(); srcPile++) {</span>
<span class="nc" id="L395">      List&lt;ValueCard&gt; src = piles.get(srcPile);</span>
<span class="nc bnc" id="L396" title="All 2 branches missed.">      if (src.isEmpty()) {</span>
<span class="nc" id="L397">        continue;</span>
      }
<span class="nc" id="L399">      ValueCard card = src.get(src.size() - 1);</span>
<span class="nc bnc" id="L400" title="All 2 branches missed.">      for (int destPile = 0; destPile &lt; piles.size(); destPile++) {</span>
<span class="nc bnc" id="L401" title="All 2 branches missed.">        if (srcPile == destPile) {</span>
<span class="nc" id="L402">          continue;</span>
        }
<span class="nc" id="L404">        List&lt;ValueCard&gt; dest = piles.get(destPile);</span>
<span class="nc bnc" id="L405" title="All 2 branches missed.">        if (dest.isEmpty()) {</span>
<span class="nc bnc" id="L406" title="All 2 branches missed.">          if (card.possibleRank == PossibleRank.King) {</span>
<span class="nc" id="L407">            return true;</span>
          }
        } else {
<span class="nc" id="L410">          ValueCard destCard = dest.get(dest.size() - 1);</span>
<span class="nc bnc" id="L411" title="All 2 branches missed.">          if (card.possibleRank.getNumber() == destCard.possibleRank.getNumber() - 1</span>
<span class="nc bnc" id="L412" title="All 2 branches missed.">              &amp;&amp; oppositeColorCheck(card.possibleSuits.getSymbol(),</span>
<span class="nc" id="L413">              destCard.possibleSuits.getSymbol())) {</span>
<span class="nc" id="L414">            return true;</span>
          }
        }
      }
    }
<span class="nc bnc" id="L419" title="All 2 branches missed.">    if (handDeckChecker()) {</span>
<span class="nc" id="L420">      return true;</span>
    }
<span class="nc" id="L422">    return false;</span>
  }

  /**
   * Helper for available move. Handles hand and deck checks for available moves.
   *
   * @return a boolean if an available move can be made from the deck or hand.
   */
  protected boolean handDeckChecker() {
<span class="nc bnc" id="L431" title="All 2 branches missed.">    if (!hand.isEmpty()) {</span>
<span class="nc bnc" id="L432" title="All 2 branches missed.">      for (int hands = 0; hands &lt; hand.size(); hands++) {</span>
<span class="nc" id="L433">        ValueCard drawCard = (ValueCard) hand.get(hands);</span>
<span class="nc bnc" id="L434" title="All 2 branches missed.">        for (List&lt;ValueCard&gt; foundation : foundations) {</span>
<span class="nc bnc" id="L435" title="All 2 branches missed.">          if (canPlaceFoundationCheck(drawCard, foundation)) {</span>
<span class="nc" id="L436">            return true;</span>
          }
<span class="nc" id="L438">        }</span>
<span class="nc bnc" id="L439" title="All 2 branches missed.">        for (List&lt;ValueCard&gt; pile : piles) {</span>
<span class="nc bnc" id="L440" title="All 2 branches missed.">          if (pile.isEmpty()) {</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">            if (drawCard.possibleRank == PossibleRank.King) {</span>
<span class="nc" id="L442">              return true;</span>
            }
          } else {
<span class="nc" id="L445">            ValueCard topCard = pile.get(pile.size() - 1);</span>
<span class="nc bnc" id="L446" title="All 2 branches missed.">            if (drawCard.possibleRank.getNumber() == topCard.possibleRank.getNumber() - 1</span>
<span class="nc bnc" id="L447" title="All 2 branches missed.">                &amp;&amp; oppositeColorCheck(drawCard.possibleSuits.getSymbol(),</span>
<span class="nc" id="L448">                topCard.possibleSuits.getSymbol())) {</span>
<span class="nc" id="L449">              return true;</span>
            }
          }
<span class="nc" id="L452">        }</span>
      }
    }
<span class="nc bnc" id="L455" title="All 2 branches missed.">    for (ValueCard drawCard : drawDeck) {</span>
<span class="nc bnc" id="L456" title="All 2 branches missed.">      for (List&lt;ValueCard&gt; foundation : foundations) {</span>
<span class="nc bnc" id="L457" title="All 2 branches missed.">        if (canPlaceFoundationCheck(drawCard, foundation)) {</span>
<span class="nc" id="L458">          return true;</span>
        }
<span class="nc" id="L460">      }</span>
<span class="nc bnc" id="L461" title="All 2 branches missed.">      for (List&lt;ValueCard&gt; pile : piles) {</span>
<span class="nc bnc" id="L462" title="All 2 branches missed.">        if (pile.isEmpty()) {</span>
<span class="nc bnc" id="L463" title="All 2 branches missed.">          if (drawCard.possibleRank == PossibleRank.King) {</span>
<span class="nc" id="L464">            return true;</span>
          }
        } else {
<span class="nc" id="L467">          ValueCard topCard = pile.get(pile.size() - 1);</span>
<span class="nc bnc" id="L468" title="All 2 branches missed.">          if (drawCard.possibleRank.getNumber() == topCard.possibleRank.getNumber() - 1</span>
<span class="nc bnc" id="L469" title="All 2 branches missed.">              &amp;&amp; oppositeColorCheck(drawCard.possibleSuits.getSymbol(),</span>
<span class="nc" id="L470">              topCard.possibleSuits.getSymbol())) {</span>
<span class="nc" id="L471">            return true;</span>
          }
        }
<span class="nc" id="L474">      }</span>
<span class="nc" id="L475">    }</span>
<span class="nc" id="L476">    return false;</span>
  }

  @Override
  public int getScore() {
<span class="nc" id="L481">    gameInProgress();</span>
<span class="nc" id="L482">    int score = 0;</span>
<span class="nc bnc" id="L483" title="All 2 branches missed.">    for (List&lt;ValueCard&gt; cards : foundations) {</span>
<span class="nc" id="L484">      score += cards.size();</span>
<span class="nc" id="L485">    }</span>
<span class="nc" id="L486">    return score;</span>
  }

  @Override
  public int getPileHeight(int pileNum) {
<span class="nc" id="L491">    gameInProgress();</span>
<span class="nc" id="L492">    paramLessCheck(pileNum, 0);</span>
<span class="nc" id="L493">    paramLessEqualCheck(piles.size(), pileNum);</span>
<span class="nc" id="L494">    return piles.get(pileNum).size();</span>
  }

  @Override
  public ValueCard getCardAt(int pileNum, int card) {
<span class="nc" id="L499">    gameInProgress();</span>
<span class="nc" id="L500">    paramLessCheck(pileNum, 0);</span>
<span class="nc" id="L501">    paramLessEqualCheck(piles.size(), pileNum);</span>
<span class="nc" id="L502">    List&lt;ValueCard&gt; pile = piles.get(pileNum);</span>
<span class="nc" id="L503">    paramLessCheck(card, 0);</span>
<span class="nc" id="L504">    paramLessEqualCheck(pile.size(), card);</span>
<span class="nc bnc" id="L505" title="All 2 branches missed.">    if (!isCardVisible(pileNum, card)) {</span>
<span class="nc" id="L506">      throw new IllegalArgumentException(&quot;IllegalArgumentException&quot;);</span>
    }
<span class="nc" id="L508">    return pile.get(card);</span>
  }

  @Override
  public ValueCard getCardAt(int foundationPile) {
<span class="nc" id="L513">    gameInProgress();</span>
<span class="nc" id="L514">    paramLessCheck(foundationPile, 0);</span>
<span class="nc" id="L515">    paramLessEqualCheck(foundations.size(), foundationPile);</span>
<span class="nc" id="L516">    List&lt;ValueCard&gt; foundation = foundations.get(foundationPile);</span>
<span class="nc bnc" id="L517" title="All 2 branches missed.">    if (foundation.isEmpty()) {</span>
<span class="nc" id="L518">      return null;</span>
    }
<span class="nc" id="L520">    return foundation.get(foundation.size() - 1);</span>
  }

  @Override
  public boolean isCardVisible(int pileNum, int card) {
<span class="nc" id="L525">    gameInProgress();</span>
<span class="nc" id="L526">    paramLessCheck(pileNum, 0);</span>
<span class="nc" id="L527">    paramLessEqualCheck(piles.size(), pileNum);</span>
<span class="nc" id="L528">    List&lt;ValueCard&gt; cards = piles.get(pileNum);</span>
<span class="nc" id="L529">    paramLessCheck(card, 0);</span>
<span class="nc" id="L530">    paramLessEqualCheck(cards.size(), card);</span>
<span class="nc bnc" id="L531" title="All 2 branches missed.">    return (card == cards.size() - 1);</span>
  }

  @Override
  public List&lt;ValueCard&gt; getDrawCards() {
<span class="nc" id="L536">    gameInProgress();</span>
<span class="nc" id="L537">    return new ArrayList&lt;&gt;(hand);</span>
  }

  @Override
  public int getNumFoundations() {
<span class="nc" id="L542">    gameInProgress();</span>
<span class="nc" id="L543">    return foundations.size();</span>
  }

  /**
   * Helper method used to check if a card can be placed next on the foundation.
   * Checks to see if card is ace and same suit.
   *
   * @param card       card being used.
   * @param foundation foundation pile being checked.
   * @return boolean if card can be placed or not.
   */
  protected boolean canPlaceFoundationCheck(ValueCard card,
                                            List&lt;ValueCard&gt; foundation) {
<span class="nc bnc" id="L556" title="All 2 branches missed.">    if (foundation.isEmpty()) {</span>
<span class="nc bnc" id="L557" title="All 2 branches missed.">      return card.possibleRank == PossibleRank.Ace;</span>
    }
<span class="nc" id="L559">    ValueCard topCard = foundation.get(foundation.size() - 1);</span>
<span class="nc bnc" id="L560" title="All 2 branches missed.">    return card.possibleSuits.getSymbol().equals(topCard.possibleSuits.getSymbol())</span>
<span class="nc bnc" id="L561" title="All 2 branches missed.">        &amp;&amp; card.possibleRank.getNumber() == topCard.possibleRank.getNumber() + 1;</span>
  }

  /**
   * Helper method used to check if a card can be placed next on pile.
   * Checks to see if card is red or black.
   *
   * @param suitA string symbol of card 1 (going to be card being placed on pile).
   * @param suitB string symbol of card 2 (going to be pile card).
   * @return boolean if card is or is not same color.
   */
  protected boolean oppositeColorCheck(String suitA, String suitB) {
<span class="pc bpc" id="L573" title="1 of 2 branches missed.">    boolean redA = suitA.equals(PossibleSuits.Diamond.getSymbol())</span>
<span class="pc bpc" id="L574" title="1 of 2 branches missed.">        || suitA.equals(PossibleSuits.Heart.getSymbol());</span>
<span class="fc bfc" id="L575" title="All 2 branches covered.">    boolean redB = suitB.equals(PossibleSuits.Diamond.getSymbol())</span>
<span class="pc bpc" id="L576" title="1 of 2 branches missed.">        || suitB.equals(PossibleSuits.Heart.getSymbol());</span>
<span class="fc bfc" id="L577" title="All 2 branches covered.">    return redA != redB;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>